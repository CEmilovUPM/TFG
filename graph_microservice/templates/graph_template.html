{% extends "base.html" %}

{% block content %}
<div>
  <a href="/user/{{ user_id }}/goals/{{ goal_id }}" class="btn btn-secondary mb-3">
    ‚Üê Go Back
  </a>

  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <form class="row g-2 align-items-end">
        <div class="col-auto">
          <label for="yearSelect" class="form-label mb-0">Pick month:</label>
        </div>
        <div class="col-auto">
          <select id="yearSelect" name="year" class="form-select"></select>
        </div>
        <div class="col-auto">
          <select id="monthSelect" name="month" class="form-select">
            <option value="01">January</option>
            <option value="02">February</option>
            <option value="03">March</option>
            <option value="04">April</option>
            <option value="05">May</option>
            <option value="06">June</option>
            <option value="07">July</option>
            <option value="08">August</option>
            <option value="09">September</option>
            <option value="10">October</option>
            <option value="11">November</option>
            <option value="12">December</option>
          </select>
        </div>
        <div class="col-auto">
          <button id="applyMonthBtn" type="button" class="btn btn-primary">Search</button>
        </div>
      </form>
    </div>
  </div>

  <div id="graph-container">
    {{ graph_html|safe }}
  </div>
</div>

<!-- Load Plotly library -->
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<script src="{{ url_for('static', filename='js/progress.js') }}"></script>

<script>
  // Pass user_id and goal_id as global variables for JS usage
  window.userId = {{ user_id }};
  window.goalId = {{ goal_id }};
</script>
{% endblock %}